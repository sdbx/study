# 6.5 깃허브 스크립팅하기

## 학습목표
- 서비스와 훅을 설정하는 방법을 숙지한다.
- 깃허브 API를 사용하는 방법을 숙지한다.

## 개요
- 깃은 많은 방식으로 hackable함
- 깃헙을 스크립팅함으로써 customization을 하거나 외부 서비스를 integrate하기 가능

## 서비스
- 다른 상업 혹은 오픈소스 시스템과의 통합
- 지속적 통합 서비스
- 버그/이슈 트래커
- 채팅방 시스템
- 문서화 시스템
- 이메일 전송

## 후크
- 서비스 목록에 없거나 좀 더 특수한 것이 필요하다면, 서비스보다 좀 더 포괄적인 후크를 사용가능
- URL을 명시하면, 내가 원하는 이벤트가 발생했을 때 이 URL로 HTTP payload를 post함
- 일반적으로 후크를 사용하는 방식은 깃헙 후크 페이로드를 listen하는 작은 웹 서비스를 설정한 다음, 페이로드가 수신되었을 때 그 데이터로 뭔갈 하는 것임.
- 최근에 전송된 정보를 나타내주기 때문에 내가 설정한 웹후크가 잘 돌아가는지 점검 가능 / 보낸 페이로드 다시 보내기 가능
- secret을 설정하면 유효성?을 검증?할수 있다는거같은데 모르겠음 이건 깃헙 문서를 읽어보는게 나을듯 (하지만 귀찮아서 안할듯)

## 깃헙 API
웹사이트에서 할 수 있는 거의 모든 것을 자동화된 방식으로 다룰 수 있도록 많은 수의 API endpoint를 제공

### 기본적 사용례
- 인증이 필요없는 endpoint에 GET 요청 보내기
- 유저나 오픈소스 프로젝트의 read-only 정보 획득 가능
- `curl https://api.github.com/users/logic-finder`

### 인증하는 방법
- 이슈에 댓글달기 같은거 하려면 인증이 필요함
- 인증을 하면 rate limit이 늘어남 (내가 분탕이 될게)
- 아뒤+비번으로도 가능하지만, **personal access token**을 사용하는게 일반적으로 나음
   - 토큰이 사용될 범위를 지정할 수 있으니까
   - 토큰이 필요없어지면 revoke할 수 있으니까
- 토큰이 사용될 범위와 적절한 설명 작성 후 토큰 복사해놓기 (한번만 보여줌)

### 풀 리퀘스트의 상태 변경하기
- 각각의 커밋은 하나 이상의 상태를 가질 수 있음
- 해당 상태를 질의하거나 추가할 수 있는 API가 존재함
- 대부분의 ci툴과 테스트 서비스들이 이 api를 사용해 푸시된 코드를 테스트함으로써 push에 반응하고 해당 커밋이 모든 테스트를 통과했는지 보고함
- 이 밖에도, 이 api를 활용하여 커밋 메시지가 적절하게 format되었는지, submitter가 기여 가이드라인을 준수하였는지, 커밋이 유효하게 서명되었는지 등을 점검 가능
- 성공하면 초록색 v표시, 실패하면 빨간색 x표시가 커밋해시 왼쪽에 뜸
- PR의 마지막 커밋의 상태가 실패면 경고 표시가 나옴
- 작은 웹서버를 만들어놓고 웹후크핸들러를 작성해놓으면 되는 것 같음

## Octokit
curl과 간단한 http 요청으로도 위의 일들을 할수있지만 오픈소스 라이브러리를 사용하면 좀더 idiomatic한 방식으로 api를 사용가능

## 영어 공부
- generic: 포괄적인
- payload: 전송된 데이터 속에 있는 실제 정보나 메시지로서, 자동적으로 생성된 메타데이터와는 대조적이다.
- idiomatic: (표현이 native speaker처럼) 자연스러운