# 10.4 Packfile

## 학습목표
- 팩파일에 대해 이해한다.

## 요약
- 깃은 저장하는 오브젝트를 gzip으로 압축해서 보관하는 듯
- 조금만 수정된 같은 파일을 2벌 보관하면 공간 아까우니까 델타를 저장하자는게 팩파일의 개념
- 오브젝트를 처음 저장할때의 format을 loose object format이라고 함
- 깃은 특정 상황에 loose object들을 묶어서 하나의 packfile로 만듦
   - 너무 많은 loose object가 있을때
   - 직접 `git gc`를 했을때
   - 원격 서버에 push했을때
- 오브젝트를 패킹할때, 비슷한 이름을 가지고 비슷한 크기를 가진 파일을 찾아서 한 버전의 파일에서 다음 버전까지의 델타를 저장함
- `.git/objects/pack` 디렉토리에 아래에 팩파일(.pack)과 인덱스파일(.idx)이 저장됨
   - 팩파일에는 오브젝트가 들어있음
   - 인덱스파일은 팩파일 내에서 오브젝트를 빨리 찾기 위해 offset을 저장함
- `git verify-pack -v <idxfile>` 으로 팩파일에 뭐가 들어있는지 볼 수 있음
- 최신버전의 파일이 원본으로 저장되고 이전버전이 델타로 저장된다
   - 최근 파일에 빠르게 접근할 필요가 있을 가능성이 높기 때문에 그러함
- 언제든지 repack될 수 있음
   - 깃은 가끔 db를 repack해서 공간절약을 시도
   - 수동으로 git gc해도 됨
