# 2.6 태그 붙이기

## 학습목표

- 존재하는 태그를 나열하는 방법 알기
- 태그를 생성하는 방법 알기
- 태그를 삭제하는 방법 알기
- 태그의 종류 이해하기

## 태그란?

태그[tag]란 레포지토리의 히스토리 상에서 **특정한 지점을 중요하다고 표시하는 것**이다. 보통 릴리즈되는 지점을 `v1.0` 과 같은 식으로 표시한다.

### 참고: 유의적 버전

`MAJOR.MINOR.PATCH-METADATA` 주.부.수   Note: 주인 主, 버금 副, 닦을 修 ⇒ 고치다, 손질하다

와 같은 형태로 이루어져 있는데, MAJOR는 **호환되지 않는[incompatible] API 변경**이 있을때 증가되고, MINOR는 **이전 버전과 호환되는[backward-compatible] 기능 추가**를 했을때 증가되고, PATCH는 **이전 버전과 호환되는 버그 수정**을 했을때 올라간다. PATCH 뒤에 추가적으로 프리릴리즈나 빌드 메타데이터를 붙일 수 있다. 예시: `5.8.3-rc0` (rc는 릴리즈 후보 [release candidate] 라는 뜻)

## 태그 확인하기

```bash
# 전체 나열
git tag [-l 혹은 --list]

# 특정 버전만 (와일드카드를 쓰면 list 옵션을 꼭 지정해줘야 함!)
git tag "v1.0*" --list
```

## 태그의 종류

경량 태그[lightweight] 와 주석 태그[annotated] 의 2종류가 있다.

경량 태그는 태그 이름 외에 아무 정보도 가지고 있지 않은, 특정한 커밋을 가리키는 포인터일 뿐이다. 본질적으로 파일에 저장된 커밋의 체크섬일 뿐이라고 함.

그러나, 주석 태그는 체크섬될뿐만 아니라, 태그를 남긴 사람의 이름, 이메일, 시간, 태그할때 남긴 메시지를 보관하며, 또한 gpg로 서명될수도 있다.

일반적으로는 주석 태그를 만들어서 이러한 정보를 함께 저장하는것이 권장되지만, 임시로 사용할 태그가 필요한 경우에는 경량 태그를 사용할 수 있다.

## 주석 태그 만드는 법

```bash
# 현재 위치한 브랜치의 최신 커밋에 태그가 되는 것으로 보임
git tag -a v0.1.0
-m 옵션 => 태그 메시지를 이 줄에서 바로 작성. 이 옵션을 주지 않으면 텍스트 에디터가 열림.
-s 옵션 => 이 태그에 gpg 서명함
```

## 경량 태그 만드는 법

-a, -s, -m 옵션 없이 태그명만 입력한다: `git tag v0.1.1`

## 태그 내용 확인하는 법

`git show tagname` 을 하면 된다.

주석 태그의 경우, 태그를 한 사람, 이 커밋이 태그된 날짜, 태그 메시지, 이 태그에 결부된 커밋이 출력된다.

경량 태그의 경우, 이 태그에 결부된 커밋만을 보여준다.

## 이전 커밋에 태그하는 방법

`git tag ... hash` 체크섬 전체 혹은 일부를 tag 명령어의 맨 마지막에 제공하면 된다.

## 태그를 원격에 공유하는 법

`git push origin tagname` 을 하면 된다. (브랜치를 push하는것과 동일)

push할 태그가 많을 경우 `git push origin --tags` 을 하면 원격에는 없는 태그들이 일괄적으로 전송된다.

참고로 모든 종류의 태그가 다 전송되며, 경량 태그만 보내는 옵션은 없다. 그러나, `--follow-tags` 를 하면 주석 태그만이 전송된다.

## 태그 삭제하는 법

```bash
# 로컬에 있는 태그 삭제하기
git tag -d <tag>

# 원격에 있는 태그 삭제법 1
# : 앞에 있는 null값이 <tag>에 push되어, 사실상 지우는 것
git push <remote> :refs/tags/<tag>

# 원격에 있는 태그 삭제법 2
git push <remote> --delete <tag>
```

## 태그가 달린 곳으로 이동하기

`git checkout <tag>` 하면 해당 태그가 달린 곳으로 가는데, detached HEAD라는 상태가 된다. 이 상태에서는 커밋을 남겨도 어떠한 브랜치에도 속하지 않게 되므로 해당 커밋의 해쉬값이 아니고서는 이 커밋에 접근할 수 없게 된다. 따라서 커밋을 남기고 싶다면 브랜치를 먼저 만드는게 좋다.

## 생각

태그명과 브랜치명이 동일하면 당황스러운 상황에 처할수도 있으니까 주의… ⇒ [참고](https://stackoverflow.com/questions/32609195/git-tags-with-the-same-name-with-a-branch)

detached HEAD라는게 뭔지는 책을 계속 읽어가면서 알아보는 것으로…

## 영단어

tag ⇒ 꼬리표를 붙이다

straightforward ⇒ 간단한, 솔직한

annotate ⇒ 주석을 달다

after the fact ⇒ 사후에